<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Divorcios Online - Consulta</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="bg-light">

  <div class="container py-5">
    <h1 class="mb-4">Solicita tu Consulta Gratuita</h1>

    <form id="consulta-form" class="bg-white p-4 rounded shadow-sm">
      <div class="mb-3">
        <label for="nombre" class="form-label">Nombre completo</label>
        <input type="text" class="form-control" id="nombre" name="nombre" required />
      </div>

      <div class="mb-3">
        <label for="correo" class="form-label">Correo electrónico</label>
        <input type="email" class="form-control" id="correo" name="correo" required />
      </div>

      <div class="mb-3">
              <label for="tipoDivorcio" class="form-label">Tipo de Divorcio</label>
              <select class="form-select" id="tipoDivorcio" name="tipoDivorcio" required>
                <option value="">Selecciona una opción</option>
                <option value="mutuo">Divorcio de mutuo acuerdo</option>
                <option value="unilateral">Divorcio por causa determinada</option>
                <option value="internacional">Divorcio al vapor</option>
              </select>
              <div class="invalid-feedback">Selecciona un tipo de divorcio.</div>
            </div>

      <div class="mb-3">
        <label for="mensaje" class="form-label">Mensaje</label>
        <textarea class="form-control" id="mensaje" name="mensaje" rows="4" required></textarea>
      </div>

      <button type="submit" class="btn btn-primary w-100">Enviar Consulta</button>
    </form>

    <div id="resultado" class="mt-4"></div>
  </div>

  <script>
    document.getElementById('consulta-form').addEventListener('submit', async function(e) {
      e.preventDefault();

      const datos = {
        nombre: this.nombre.value.trim(),
        correo: this.correo.value.trim(),
        tipoDivorcio: this.tipoDivorcio.value.trim(),
        mensaje: this.mensaje.value.trim()
      };

      try {
        const respuesta = await fetch('http://localhost:5000/api/consulta', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(datos)
        });

        const data = await respuesta.json();

        if (respuesta.ok) {
          document.getElementById('resultado').innerHTML =
            `<div class="alert alert-success">${data.message}</div>`;
          this.reset();
        } else {
          document.getElementById('resultado').innerHTML =
            `<div class="alert alert-danger">${data.message}</div>`;
        }
      } catch (error) {
        document.getElementById('resultado').innerHTML =
          `<div class="alert alert-danger">Error al enviar la consulta. Inténtalo de nuevo.</div>`;
      }
    });
  </script>

</body>
</html>
